// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int            @id @default(autoincrement())
  id_role      Int            @db.Integer
  username     String         @unique @db.VarChar(255)
  password     String         @db.VarChar(255)
  name         String         @db.VarChar(255)
  phone        String         @db.VarChar(255)
  address      String         @db.Text
  status       Boolean        @default(false)
  created_at   DateTime       @default(now()) @db.Timestamptz()
  updated_at   DateTime       @updatedAt @db.Timestamptz()
  role         Role           @relation(fields: [id_role], references: [id])
  SpecialPrice SpecialPrice[]

  @@map("users")
}

model Role {
  id         Int      @id @default(autoincrement())
  name       String   @db.VarChar(255)
  created_at DateTime @default(now()) @db.Timestamptz()
  updated_at DateTime @updatedAt @db.Timestamptz()
  User       User[]

  @@map("roles")
}

model Car {
  id              Int      @id @default(autoincrement())
  id_car_brand    Int      @db.Integer
  name            String   @db.VarChar(255)
  production_year String   @db.VarChar(255)
  type            String?  @db.VarChar(255)
  created_at      DateTime @default(now()) @db.Timestamptz()
  updated_at      DateTime @updatedAt @db.Timestamptz()
  carBrand        CarBrand @relation(fields: [id_car_brand], references: [id])

  @@map("cars")
}

model CarBrand {
  id          Int      @id @default(autoincrement())
  name        String   @db.VarChar(255)
  manufacture String   @db.VarChar(255)
  created_at  DateTime @default(now()) @db.Timestamptz()
  updated_at  DateTime @updatedAt @db.Timestamptz()
  Car         Car[]

  @@map("car_brands")
}

model SparePart {
  id                  Int            @id @default(autoincrement())
  id_spare_part_brand Int            @db.Integer
  id_category         Int            @db.Integer
  id_car              Int?           @db.Integer
  id_supplier         Int?           @db.Integer
  name                String         @db.VarChar(255)
  part_no             String         @db.VarChar(255)
  genuine             Boolean        @db.Boolean
  stock               Int            @default(0) @db.Integer
  capital_price       BigInt         @db.BigInt
  sell_method         Int            @default(0) @db.Integer
  is_available        Boolean        @default(false) @db.Boolean
  sale_price          BigInt         @db.BigInt
  description         String         @db.Text
  supply_date         DateTime       @db.Timestamptz()
  created_at          DateTime       @default(now()) @db.Timestamptz()
  updated_at          DateTime       @updatedAt @db.Timestamptz()
  category            Category       @relation(fields: [id_category], references: [id])
  sparePartBrand      SparePartBrand @relation(fields: [id_spare_part_brand], references: [id])
  SpecialPrice        SpecialPrice[]

  @@map("spare_parts")
}

model SparePartBrand {
  id          Int         @id @default(autoincrement())
  name        String      @db.VarChar(255)
  manufacture String      @db.VarChar(255)
  created_at  DateTime    @default(now()) @db.Timestamptz()
  updated_at  DateTime    @updatedAt @db.Timestamptz()
  SparePart   SparePart[]

  @@map("spare_part_brands")
}

model Category {
  id          Int         @id @default(autoincrement())
  name        String      @db.VarChar(255)
  description String      @db.VarChar(255)
  created_at  DateTime    @default(now()) @db.Timestamptz()
  updated_at  DateTime    @updatedAt @db.Timestamptz()
  SparePart   SparePart[]

  @@map("categories")
}

model Supplier {
  id                Int      @id @default(autoincrement())
  company_name      String   @db.VarChar(255)
  company_phone     String   @db.VarChar(255)
  pic_name          String   @db.VarChar(255)
  pic_phone         String   @db.VarChar(255)
  bank_account      String   @db.VarChar(255)
  bank_account_name String   @db.VarChar(255)
  address           String?  @db.Text
  created_at        DateTime @default(now()) @db.Timestamptz()
  updated_at        DateTime @updatedAt @db.Timestamptz()

  @@map("suppliers")
}

model SpecialPrice {
  id            Int       @id @default(autoincrement())
  id_spare_part Int       @db.Integer
  id_user       Int       @db.Integer
  price         BigInt    @db.BigInt
  created_at    DateTime  @default(now()) @db.Timestamptz()
  updated_at    DateTime  @updatedAt @db.Timestamptz()
  SparePart     SparePart @relation(fields: [id_spare_part], references: [id])
  User          User      @relation(fields: [id_user], references: [id])

  @@map("special_prices")
}

model File {
  id         Int      @id @default(autoincrement())
  file_id    Int      @db.Integer
  file_model String   @db.VarChar(255)
  name       String   @db.VarChar(255)
  created_at DateTime @default(now()) @db.Timestamptz()
  updated_at DateTime @updatedAt @db.Timestamptz()

  @@map("files")
}
